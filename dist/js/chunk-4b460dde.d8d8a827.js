(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b460dde"],{"3b7b":function(t,e,a){"use strict";a("e620")},b0c0:function(t,e,a){var c=a("83ab"),n=a("5e77").EXISTS,o=a("e330"),s=a("9bf2").f,r=Function.prototype,l=o(r.toString),i=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=o(i.exec),d="name";c&&!n&&s(r,d,{configurable:!0,get:function(){try{return u(i,l(this))[1]}catch(t){return""}}})},d398:function(t,e,a){"use strict";a.r(e);a("b680"),a("b0c0");var c=a("7a23"),n=function(t){return Object(c["C"])("data-v-1c9e0cab"),t=t(),Object(c["A"])(),t},o=n((function(){return Object(c["h"])("header",null,[Object(c["h"])("div",{class:"d-flex align-items-center"},[Object(c["h"])("i",{class:"bi bi-cart-fill text-warning me-3 fs-2"}),Object(c["h"])("h2",{class:"h1 mb-0 text-primary"},"My cart")])],-1)})),s={class:""},r={class:"row align-items-start align-items-xl-center mb-0 list-unstyled"},l={class:"col-2 col-md-1 align-self-lg-center text-center"},i=["onClick"],u=n((function(){return Object(c["h"])("i",{class:"bi bi-x"},null,-1)})),d=[u],b={class:"col-4 col-md-3 text-center"},p=["src","alt"],m={key:1,class:"badge bg-primary fst-italic text-warning rounded-pill"},f={class:"col-6 col-md-8"},h={class:"row justify-content-between align-items-xl-center"},j={class:"col-12 col-md-6 col-lg-4 col-xl-4"},O={class:"fs-5 mb-md-0"},g={class:"col-12 col-md-6 col-lg-4 col-xl-3"},v={class:"input-group input-group-sm"},x=["onUpdate:modelValue","onChange"],y={class:"input-group-text fs-6"},C={class:"col-12 col-lg-4 col-xl-2"},k={class:"text-end py-2 py-lg-0 price-font border-adjusted"},w={class:"col-12 col-xl-3"},U={class:"text-end pt-2 price-font"},T={key:0},V={key:1},M={class:"text-warning"},A={key:0,class:"mt-2 total-price-font"},$={key:0,class:"text-end text-danger"},z={key:1,class:"text-end"},F={class:"text-danger"},E={class:"text-danger fs-6"},R={key:0,class:"row justify-content-center"},P={class:"col-lg-6"},S={class:"py-5"},L=n((function(){return Object(c["h"])("h3",{class:"h4 mb-3"},"Use Coupon",-1)})),_={class:"input-group input-group-sm"},q=["placeholder"],D=["disabled"],I=["disabled"],J={key:0,class:"text-warning fs-6"},N=Object(c["j"])("* See Coupon Usage "),B=n((function(){return Object(c["h"])("i",{class:"bi bi-arrow-down"},null,-1)})),W=[N,B],Y=Object(c["i"])('<div class="accordion mt-3" id="accordionExample" data-v-1c9e0cab><div class="accordion-item" data-v-1c9e0cab><h4 class="accordion-header" id="headingOne" data-v-1c9e0cab><button class="accordion-button collapsed py-2 px-3 fs-6 text-muted" type="button" data-bs-toggle="collapse" data-bs-target="#couponUsage" aria-expanded="true" aria-controls="collapseOne" data-v-1c9e0cab> Coupon Usage </button></h4><div id="couponUsage" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#accordionExample" data-v-1c9e0cab><div class="accordion-body" data-v-1c9e0cab><ul class="fs-6 list-unstyled mb-0" data-v-1c9e0cab><li data-v-1c9e0cab><div class="d-flex py-1" data-v-1c9e0cab><div data-v-1c9e0cab><span data-v-1c9e0cab>$120</span><i class="bi bi-arrow-right mx-2" data-v-1c9e0cab></i><span class="fst-italic fw-bold" data-v-1c9e0cab>CMDBTEN</span></div><span class="badge bg-primary ms-auto fst-italic" data-v-1c9e0cab>10% off</span></div></li><li data-v-1c9e0cab><div class="d-flex py-1" data-v-1c9e0cab><div data-v-1c9e0cab><span data-v-1c9e0cab>$240</span><i class="bi bi-arrow-right mx-2" data-v-1c9e0cab></i><span class="fst-italic fw-bold" data-v-1c9e0cab>CMDBFIFTEEN</span></div><span class="badge bg-primary ms-auto fst-italic" data-v-1c9e0cab>15% off</span></div></li><li data-v-1c9e0cab><div class="d-flex py-1" data-v-1c9e0cab><div data-v-1c9e0cab><span data-v-1c9e0cab>$360</span><i class="bi bi-arrow-right mx-2" data-v-1c9e0cab></i><span class="fst-italic fw-bold" data-v-1c9e0cab>CMDBTWENTY</span></div><span class="badge bg-primary ms-auto fst-italic" data-v-1c9e0cab>20% off</span></div></li></ul></div></div></div></div>',1),Q=n((function(){return Object(c["h"])("h3",{class:"h4"},"Delivery Info",-1)})),X={class:"mb-3"},H=n((function(){return Object(c["h"])("label",{for:"email",class:"form-label"},"Email*",-1)})),G={class:"mb-3"},K=n((function(){return Object(c["h"])("label",{for:"name",class:"form-label"},"姓名*",-1)})),Z={class:"mb-3"},tt=n((function(){return Object(c["h"])("label",{for:"tel",class:"form-label"},"手機*",-1)})),et={class:"mb-3"},at=n((function(){return Object(c["h"])("label",{for:"address",class:"form-label"},"地址*",-1)})),ct={class:"mb-3"},nt=n((function(){return Object(c["h"])("label",{for:"message",class:"form-label"},"留言",-1)})),ot=n((function(){return Object(c["h"])("div",{class:"text-end"},[Object(c["h"])("button",{class:"btn btn-warning",type:"submit"},"Submit")],-1)})),st={key:1,class:"d-flex align-items-center justify-content-center h-100"},rt=Object(c["j"])("pick some movies now");function lt(t,e,a,n,u,N){var B=Object(c["J"])("Loading"),lt=Object(c["J"])("Field"),it=Object(c["J"])("error-message"),ut=Object(c["J"])("Form"),dt=Object(c["J"])("router-link");return Object(c["z"])(),Object(c["g"])(c["a"],null,[Object(c["k"])(B,{active:u.isLoading},null,8,["active"]),Object(c["h"])("div",{class:Object(c["s"])(["container py-5 px-3 px-xl-0",{"h-100":!u.cart.length}])},[o,Object(c["h"])("main",{class:Object(c["s"])({"h-100":!u.cart.length})},[Object(c["h"])("section",s,[(Object(c["z"])(!0),Object(c["g"])(c["a"],null,Object(c["H"])(u.cart,(function(t){return Object(c["z"])(),Object(c["g"])("div",{class:"border-bottom border-primary pb-3 pt-4",key:t.id},[Object(c["h"])("ul",r,[Object(c["h"])("li",l,[Object(c["h"])("button",{onClick:Object(c["X"])((function(e){return N.deleteProduct(t)}),["prevent"]),type:"button",class:"btn btn-outline-warning btn-sm px-1 py-0 border-1"},d,8,i)]),Object(c["h"])("li",b,[t.product.imageUrl?(Object(c["z"])(),Object(c["g"])("img",{key:0,src:t.product.imageUrl[0],class:"img-adjusted img-fluid d-inline-block",alt:t.product.title},null,8,p)):(Object(c["z"])(),Object(c["g"])("span",m,"Subscription"))]),Object(c["h"])("li",f,[Object(c["h"])("div",h,[Object(c["h"])("div",j,[Object(c["h"])("h2",O,Object(c["M"])(t.product.title),1)]),Object(c["h"])("div",g,[Object(c["h"])("div",v,[Object(c["W"])(Object(c["h"])("input",{type:"number",class:"form-control","aria-label":"number","onUpdate:modelValue":function(e){return t.qty=e},min:"1",onChange:function(e){return N.updateProductTotal(t)}},null,40,x),[[c["Q"],t.qty,void 0,{number:!0}]]),Object(c["h"])("span",y,"/ "+Object(c["M"])(t.product.unit),1)])]),Object(c["h"])("div",C,[Object(c["h"])("div",k," Price: $"+Object(c["M"])(t.product.price),1)]),Object(c["h"])("div",w,[Object(c["h"])("div",U,[u.isCouponUsed?Object(c["f"])("",!0):(Object(c["z"])(),Object(c["g"])("div",T," Total: $"+Object(c["M"])(t.total.toFixed(2)),1)),u.isCouponUsed?(Object(c["z"])(),Object(c["g"])("div",V,[Object(c["h"])("del",null,"Total: $"+Object(c["M"])(t.total.toFixed(2)),1),Object(c["h"])("div",M," After discount: $"+Object(c["M"])(t.final_total.toFixed(2)),1)])):Object(c["f"])("",!0)])])])])])])})),128)),u.cart.length?(Object(c["z"])(),Object(c["g"])("div",A,[u.isCouponUsed?(Object(c["z"])(),Object(c["g"])("div",z,[Object(c["h"])("del",null,"Total: $"+Object(c["M"])(N.totalAmount.total.toFixed(2)),1),Object(c["h"])("div",F," After discount: $"+Object(c["M"])(N.totalAmount.finalTotal.toFixed(2)),1),Object(c["h"])("div",E,Object(c["M"])(N.discountRatio)+"% off",1)])):(Object(c["z"])(),Object(c["g"])("div",$," Total: $"+Object(c["M"])(N.totalAmount.total.toFixed(2)),1))])):Object(c["f"])("",!0)]),u.cart.length?(Object(c["z"])(),Object(c["g"])("section",R,[Object(c["h"])("div",P,[Object(c["h"])("section",S,[L,Object(c["h"])("div",_,[Object(c["W"])(Object(c["h"])("input",{type:"text",class:"form-control",placeholder:N.totalAmount.total<=120?"No coupon available ...":"Your coupon is ...","onUpdate:modelValue":e[0]||(e[0]=function(t){return u.couponCode=t}),disabled:"","aria-label":"input coupon","aria-describedby":"button-addon2"},null,8,q),[[c["Q"],u.couponCode]]),u.isCouponUsed?(Object(c["z"])(),Object(c["g"])("button",{key:0,class:"btn btn-outline-secondary text-muted",id:"button-addon2",type:"button",onClick:e[1]||(e[1]=function(){return N.useCoupon&&N.useCoupon.apply(N,arguments)}),disabled:u.isCouponUsed}," Coupon used ",8,D)):(Object(c["z"])(),Object(c["g"])("button",{key:1,class:"btn btn-outline-warning",type:"button",onClick:e[2]||(e[2]=function(){return N.useCoupon&&N.useCoupon.apply(N,arguments)}),id:"button-addon2",disabled:N.totalAmount.total<=120}," Use Coupon ",8,I))]),u.isCouponUsed?Object(c["f"])("",!0):(Object(c["z"])(),Object(c["g"])("small",J,W)),Y]),Object(c["h"])("section",null,[Q,Object(c["k"])(ut,{onSubmit:N.onSubmit},{default:Object(c["V"])((function(t){var a=t.errors;return[Object(c["h"])("div",X,[H,Object(c["k"])(lt,{id:"email",name:"email",type:"email",class:Object(c["s"])(["form-control",{"is-invalid":a["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:u.form.user.email,"onUpdate:modelValue":e[3]||(e[3]=function(t){return u.form.user.email=t})},null,8,["class","modelValue"]),Object(c["k"])(it,{name:"email",class:"invalid-feedback"})]),Object(c["h"])("div",G,[K,Object(c["k"])(lt,{id:"name",name:"name",type:"text",class:Object(c["s"])(["form-control",{"is-invalid":a["name"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:u.form.user.name,"onUpdate:modelValue":e[4]||(e[4]=function(t){return u.form.user.name=t})},null,8,["class","modelValue"]),Object(c["k"])(it,{name:"name",class:"invalid-feedback"})]),Object(c["h"])("div",Z,[tt,Object(c["k"])(lt,{id:"tel",name:"tel",type:"tel",class:Object(c["s"])(["form-control",{"is-invalid":a["tel"]}]),placeholder:"請輸入手機",rules:"numeric|length: 10|required",modelValue:u.form.user.tel,"onUpdate:modelValue":e[5]||(e[5]=function(t){return u.form.user.tel=t})},null,8,["class","modelValue"]),Object(c["k"])(it,{name:"tel",class:"invalid-feedback"})]),Object(c["h"])("div",et,[at,Object(c["k"])(lt,{id:"address",name:"address",type:"text",class:Object(c["s"])(["form-control",{"is-invalid":a["address"]}]),placeholder:"請輸入地址",rules:"required",modelValue:u.form.user.address,"onUpdate:modelValue":e[6]||(e[6]=function(t){return u.form.user.address=t})},null,8,["class","modelValue"]),Object(c["k"])(it,{name:"address",class:"invalid-feedback"})]),Object(c["h"])("div",ct,[nt,Object(c["k"])(lt,{id:"message",name:"message",as:"textarea",class:"form-control",modelValue:u.form.message,"onUpdate:modelValue":e[7]||(e[7]=function(t){return u.form.message=t})},null,8,["modelValue"])]),ot]})),_:1},8,["onSubmit"])])])])):Object(c["f"])("",!0),u.cart.length?Object(c["f"])("",!0):(Object(c["z"])(),Object(c["g"])("div",st,[Object(c["k"])(dt,{to:{name:"AllProducts"},class:"btn btn-warning"},{default:Object(c["V"])((function(){return[rt]})),_:1})]))],2)],2)],64)}var it=a("1da1"),ut=(a("96cf"),a("d3b7"),a("99af"),{data:function(){return{cart:[],discountTotal:"",couponCode:"",isLoading:!1,isCouponUsed:!1,form:{user:{name:"Andy",email:"123@gmail.com",tel:"0987654321",address:"asd"},message:""}}},inject:["emitter"],computed:{totalAmount:function(){var t=this.cart.reduce((function(t,e){return t+e.total}),0),e=this.cart.reduce((function(t,e){return t+e.final_total}),0);return{total:t,finalTotal:e}},discountRatio:function(){var t=100*(1-this.totalAmount.finalTotal/this.totalAmount.total).toFixed(2);return t}},methods:{assignCoupon:function(){this.totalAmount.total>=120&&(this.couponCode="CMDBTEN"),this.totalAmount.total>=240&&(this.couponCode="CMDBFIFTEEN"),this.totalAmount.total>=360&&(this.couponCode="CMDBTWENTY")},resetCoupon:function(){this.isCouponUsed=!1,this.couponCode=""},onSubmit:function(){var t=this;return Object(it["a"])(regeneratorRuntime.mark((function e(){var a,c,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/order"),c=t.form,e.next=5,t.$http.post(a,{data:c}).catch((function(t){return console.log(t)}));case 5:n=e.sent,t.isLoading=!1,t.$router.push({name:"UserCheckout",params:{orderID:n.data.orderId}});case 8:case"end":return e.stop()}}),e)})))()},useCoupon:function(){var t=this;return Object(it["a"])(regeneratorRuntime.mark((function e(){var a,c,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.assignCoupon(),a={code:t.couponCode},c="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/coupon"),e.next=5,t.$http.post(c,{data:a}).catch((function(t){return console.log(t)}));case 5:return n=e.sent,e.next=8,t.getCartProduct();case 8:t.isCouponUsed=n.data.success,t.discountTotal=n.data.data.final_total;case 10:case"end":return e.stop()}}),e)})))()},updateProductTotal:function(t){var e=this;return Object(it["a"])(regeneratorRuntime.mark((function a(){var c,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.isLoading=!0,c={product_id:t.product_id,qty:t.qty},n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/cart/").concat(t.id),a.next=5,e.$http.put(n,{data:c}).catch((function(t){return console.log(t)}));case 5:return a.next=7,e.getCartProduct();case 7:e.isLoading=!1;case 8:case"end":return a.stop()}}),a)})))()},getCartProduct:function(){var t=this;return Object(it["a"])(regeneratorRuntime.mark((function e(){var a,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/cart"),e.next=4,t.$http.get(a).catch((function(t){return console.log(t)}));case 4:c=e.sent,t.cart=c.data.data.carts,t.resetCoupon(),t.isLoading=!1;case 8:case"end":return e.stop()}}),e)})))()},deleteProduct:function(t){var e=this;return Object(it["a"])(regeneratorRuntime.mark((function a(){var c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return c="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/cart/").concat(t.id),a.next=3,e.$http.delete(c).catch((function(t){return console.log(t)}));case 3:return a.next=5,e.getCartProduct();case 5:e.emitter.emit("calculate-product-number",e.cart.length);case 6:case"end":return a.stop()}}),a)})))()}},created:function(){window.scrollTo(0,-1e3),this.getCartProduct()}}),dt=(a("3b7b"),a("d959")),bt=a.n(dt);const pt=bt()(ut,[["render",lt],["__scopeId","data-v-1c9e0cab"]]);e["default"]=pt},e620:function(t,e,a){}}]);
//# sourceMappingURL=chunk-4b460dde.d8d8a827.js.map