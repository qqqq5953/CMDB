(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20fe2e"],{b615:function(e,t,o){"use strict";o.r(t);var n=o("7a23"),a={class:"container py-5 px-3 px-xl-0"},c={class:"d-flex align-items-center justify-content-between"},l=Object(n["h"])("div",{class:"d-flex align-items-center"},[Object(n["h"])("i",{class:"bi bi-ticket-perforated-fill text-warning me-3 fs-1"}),Object(n["h"])("h2",{class:"h1 mb-0 text-primary"},"優惠券")],-1),s={class:"text-end"},u={class:"table-responsive my-4"},i={class:"table align-middle"},r=Object(n["h"])("thead",null,[Object(n["h"])("tr",null,[Object(n["h"])("th",{scope:"col"},"名稱"),Object(n["h"])("th",{scope:"col"},"代碼"),Object(n["h"])("th",{scope:"col",class:"text-end text-nowrap"},"折扣百分比"),Object(n["h"])("th",{scope:"col"},"到期日"),Object(n["h"])("th",{scope:"col",class:"text-nowrap"},"是否套用"),Object(n["h"])("th",{scope:"col"},"編輯")])],-1),d={scope:"row"},p={class:"text-end"},b={key:0,class:"text-success"},h={key:1,class:"text-muted"},m={class:"btn-group btn-group-sm",role:"group"},j=["onClick"],O=["onClick"];function f(e,t,o,f,g,C){var v=Object(n["J"])("Loading"),x=Object(n["J"])("Pagination"),w=Object(n["J"])("CouponEditModal"),y=Object(n["J"])("CouponDeleteModal");return Object(n["z"])(),Object(n["g"])(n["a"],null,[Object(n["k"])(v,{active:g.isLoading},null,8,["active"]),Object(n["h"])("div",a,[Object(n["h"])("header",null,[Object(n["h"])("div",c,[l,Object(n["h"])("div",s,[Object(n["h"])("button",{type:"button",class:"btn btn-dark",onClick:t[0]||(t[0]=function(e){return C.openCouponEditModal(!0)})}," 新增優惠券 ")])])]),Object(n["h"])("main",u,[Object(n["h"])("table",i,[r,Object(n["h"])("tbody",null,[(Object(n["z"])(!0),Object(n["g"])(n["a"],null,Object(n["H"])(g.coupons,(function(t){return Object(n["z"])(),Object(n["g"])("tr",{key:t.id},[Object(n["h"])("th",d,Object(n["M"])(t.title),1),Object(n["h"])("td",null,Object(n["M"])(t.code),1),Object(n["h"])("td",p,Object(n["M"])(t.percent)+" %",1),Object(n["h"])("td",null,Object(n["M"])(e.$filters.date(t.due_date)),1),Object(n["h"])("td",null,[t.is_enabled?(Object(n["z"])(),Object(n["g"])("span",b,"啟用")):(Object(n["z"])(),Object(n["g"])("span",h,"未啟用"))]),Object(n["h"])("td",null,[Object(n["h"])("div",m,[Object(n["h"])("button",{type:"button",class:"btn btn-outline-primary text-nowrap",onClick:function(e){return C.openCouponEditModal(!1,t,g.pagination)}}," 編輯 ",8,j),Object(n["h"])("button",{type:"button",class:"btn btn-outline-danger text-nowrap",onClick:function(e){return C.openCouponDeleteModal(t,g.pagination)}}," 刪除 ",8,O)])])])})),128))])])]),Object(n["k"])(x,{pages:g.pagination,onChangePage:C.getCoupons,onPreviousPage:C.getCoupons,onNextPage:C.getCoupons},null,8,["pages","onChangePage","onPreviousPage","onNextPage"]),Object(n["k"])(w,{ref:"couponEditModal",coupon:g.tempCoupon,onUpdateCoupon:C.updateCoupons},null,8,["coupon","onUpdateCoupon"]),Object(n["k"])(y,{ref:"couponDeleteModal",coupon:g.tempDeleteCoupon,onDeleteCoupon:C.deleteCoupon},null,8,["coupon","onDeleteCoupon"])])],64)}var g=o("1da1"),C=o("5530"),v=(o("96cf"),o("99af"),{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"modalLabel","aria-hidden":"true",ref:"modal"}),x={class:"modal-dialog modal-md",role:"document"},w={class:"modal-content border-0"},y=Object(n["h"])("div",{class:"modal-header bg-dark"},[Object(n["h"])("h5",{class:"modal-title text-white",id:"exampleModalLabel"},[Object(n["h"])("span",null,"新增優惠券")]),Object(n["h"])("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),M={class:"modal-body"},k={class:"mb-3"},_=Object(n["h"])("label",{for:"title",class:"form-label"},"名稱",-1),D={class:"mb-3"},$=Object(n["h"])("label",{for:"code",class:"form-label"},"代碼",-1),P={class:"mb-3"},L=Object(n["h"])("label",{for:"percent",class:"form-label"},"折扣百分比",-1),E={class:"mb-3"},U=Object(n["h"])("label",{for:"due_date",class:"form-label"},"到期日",-1),z=Object(n["h"])("hr",null,null,-1),J={class:"mb-3"},R={class:"form-check"},N=Object(n["h"])("label",{class:"form-check-label",for:"is_enabled"}," 是否套用 ",-1),V={class:"modal-footer"},W=Object(n["h"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Q(e,t,o,a,c,l){return Object(n["z"])(),Object(n["g"])("div",v,[Object(n["h"])("div",x,[Object(n["h"])("div",w,[y,Object(n["h"])("div",M,[Object(n["h"])("form",null,[Object(n["h"])("div",k,[_,Object(n["W"])(Object(n["h"])("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入優惠券名稱","onUpdate:modelValue":t[0]||(t[0]=function(e){return c.tempCoupon.title=e})},null,512),[[n["Q"],c.tempCoupon.title]])]),Object(n["h"])("div",D,[$,Object(n["W"])(Object(n["h"])("input",{type:"text",class:"form-control",id:"code",placeholder:"請輸入優惠券代碼","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.tempCoupon.code=e})},null,512),[[n["Q"],c.tempCoupon.code]])]),Object(n["h"])("div",P,[L,Object(n["W"])(Object(n["h"])("input",{type:"text",class:"form-control",id:"percent",placeholder:"請輸入折扣百分比","onUpdate:modelValue":t[2]||(t[2]=function(e){return c.tempCoupon.percent=e})},null,512),[[n["Q"],c.tempCoupon.percent,void 0,{number:!0}]])]),Object(n["h"])("div",E,[U,Object(n["W"])(Object(n["h"])("input",{type:"date",class:"form-control",id:"due_date",placeholder:"請輸入到期日","onUpdate:modelValue":t[3]||(t[3]=function(e){return c.tempCoupon.due_date=e})},null,512),[[n["Q"],c.tempCoupon.due_date]])]),z,Object(n["h"])("div",J,[Object(n["h"])("div",R,[Object(n["W"])(Object(n["h"])("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.tempCoupon.is_enabled=e})},null,512),[[n["P"],c.tempCoupon.is_enabled]]),N])])])]),Object(n["h"])("div",V,[W,Object(n["h"])("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=function(t){return e.$emit("update-coupon",c.tempCoupon)})}," 新增 ")])])])],512)}var S=o("e0ae"),F={mixins:[S["a"]],props:{coupon:{type:Object,default:function(){return{}}}},data:function(){return{tempCoupon:{}}},watch:{coupon:function(){this.tempCoupon=this.coupon}}},H=o("d959"),T=o.n(H);const q=T()(F,[["render",Q]]);var A=q,B={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"modalLabel","aria-hidden":"true",ref:"modal"},G={class:"modal-dialog modal-xl",role:"document"},I={class:"modal-content border-0"},K={class:"modal-header bg-danger"},X={class:"modal-title text-white",id:"exampleModalLabel"},Y=Object(n["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Z={class:"modal-body"},ee=Object(n["j"])(" 是否刪除 "),te={class:"text-danger fw-bold"},oe=Object(n["j"])(" ？（刪除後無法復原） "),ne={class:"modal-footer"},ae=Object(n["h"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ce(e,t,o,a,c,l){return Object(n["z"])(),Object(n["g"])("div",B,[Object(n["h"])("div",G,[Object(n["h"])("div",I,[Object(n["h"])("div",K,[Object(n["h"])("h5",X,[Object(n["h"])("span",null,"刪除 "+Object(n["M"])(c.tempCoupon.title),1)]),Y]),Object(n["h"])("div",Z,[ee,Object(n["h"])("span",te,Object(n["M"])(c.tempCoupon.title),1),oe]),Object(n["h"])("div",ne,[ae,Object(n["h"])("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=function(t){return e.$emit("delete-coupon",c.tempCoupon)})}," 確認刪除 ")])])])],512)}var le={mixins:[S["a"]],props:{coupon:{type:Object}},data:function(){return{tempCoupon:{}}},watch:{coupon:function(){this.tempCoupon=this.coupon}}};const se=T()(le,[["render",ce]]);var ue=se,ie=o("1799"),re={components:{CouponEditModal:A,CouponDeleteModal:ue,Pagination:ie["a"]},inject:["pushMessageStateForDashboard"],data:function(){return{coupons:[],pagination:{},tempCoupon:{},tempDeleteCoupon:{},isNew:!1,isLoading:!1}},methods:{openCouponDeleteModal:function(e,t){this.tempDeleteCoupon=Object(C["a"])(Object(C["a"])({},e),t),this.$refs.couponDeleteModal.showModal()},deleteCoupon:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function o(){var n,a,c;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/admin/coupon/").concat(e.id),o.next=3,t.$http.delete(n).catch((function(e){return console.log(e)}));case 3:return a=o.sent,c=e.current_page,o.next=7,t.getCoupons(c);case 7:t.$refs.couponDeleteModal.hideModal(),t.pushMessageStateForDashboard(a,e,"刪除");case 9:case"end":return o.stop()}}),o)})))()},openCouponEditModal:function(e,t,o){if(e&&(this.tempCoupon={}),!e){var n=Object(C["a"])({},t),a=this.$filters.date(n.due_date);n.due_date=this.$filters.formatDate(a),this.tempCoupon=Object(C["a"])(Object(C["a"])({},n),o)}this.$refs.couponEditModal.showModal(),this.isNew=e},updateCoupons:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function o(){var n,a,c,l,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/admin/coupon"),a="post",t.isNew||(n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/admin/coupon/").concat(e.id),a="put",c=e.current_page),l={title:e.title,code:e.code,percent:e.percent,due_date:t.$filters.toUnixTimeStamp(e.due_date),is_enabled:e.is_enabled},o.next=6,t.$http[a](n,{data:l}).catch((function(e){return console.log(e)}));case 6:return s=o.sent,o.next=9,t.getCoupons(c);case 9:t.$refs.couponEditModal.hideModal(),t.pushMessageStateForDashboard(s,e,c?"更新":"新增");case 11:case"end":return o.stop()}}),o)})))()},getCoupons:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function o(){var n,a;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return t.isLoading=!0,n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/admin/coupons?page=").concat(e),o.next=4,t.$http.get(n).catch((function(e){return console.log(e)}));case 4:a=o.sent,t.coupons=a.data.coupons,t.pagination=a.data.pagination,t.isLoading=!1;case 8:case"end":return o.stop()}}),o)})))()}},created:function(){this.getCoupons()}};const de=T()(re,[["render",f]]);t["default"]=de}}]);
//# sourceMappingURL=chunk-2d20fe2e.02c17844.js.map